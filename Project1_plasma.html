<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dmytro Perepolkin">

<title>Project 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: 1;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="Project1_plasma_files/libs/clipboard/clipboard.min.js"></script>
<script src="Project1_plasma_files/libs/quarto-html/quarto.js"></script>
<script src="Project1_plasma_files/libs/quarto-html/popper.min.js"></script>
<script src="Project1_plasma_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Project1_plasma_files/libs/quarto-html/anchor.min.js"></script>
<link href="Project1_plasma_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Project1_plasma_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Project1_plasma_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Project1_plasma_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Project1_plasma_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project 1</h1>
<p class="subtitle lead">Additional assignment</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dmytro Perepolkin </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="data-overview" class="level2">
<h2 class="anchored" data-anchor-id="data-overview">Data overview</h2>
<p>The dataset is from <code>gamlss.data</code> package <span class="citation" data-cites="harrell2002PlasmaRetinolBetaCarotene">(<a href="#ref-harrell2002PlasmaRetinolBetaCarotene" role="doc-biblioref">Harrell 2002</a>)</span>. It is a cross-sectional study to investigate the relationship between personal characteristics and dietary factors, and plasma concentrations.</p>
<p>An original data frame has 315 observations of the following variables</p>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>age</code></td>
<td>age(years)</td>
</tr>
<tr class="even">
<td><code>sex</code></td>
<td>sex, 1=male, 2=female</td>
</tr>
<tr class="odd">
<td><code>smokstat</code></td>
<td>smoking status 1=never, 2=former, 3=current Smoker</td>
</tr>
<tr class="even">
<td><code>bmi</code></td>
<td>body mass index weight/(height^2)</td>
</tr>
<tr class="odd">
<td><code>vituse</code></td>
<td>vitamin use 1=yes, fairly often, 2=yes, not often, 3=no</td>
</tr>
<tr class="even">
<td><code>calories</code></td>
<td>number of calories consumed per day</td>
</tr>
<tr class="odd">
<td><code>fat</code></td>
<td>grams of fat consumed per day</td>
</tr>
<tr class="even">
<td><code>fiber</code></td>
<td>grams of fiber consumed per day</td>
</tr>
<tr class="odd">
<td><code>alcohol</code></td>
<td>number of alcoholic drinks consumed per week</td>
</tr>
<tr class="even">
<td><code>cholesterol</code></td>
<td>cholesterol consumed (mg per day)</td>
</tr>
<tr class="odd">
<td><code>betadiet</code></td>
<td>dietary beta-carotene consumed (mcg per day)</td>
</tr>
<tr class="even">
<td><code>retdiet</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></td>
<td>dietary retinol consumed (mcg per day)</td>
</tr>
<tr class="odd">
<td><code>betaplasma</code></td>
<td>plasma beta-carotene (ng/ml)</td>
</tr>
<tr class="even">
<td><code>retplasma</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></td>
<td>plasma retinol (ng/ml)</td>
</tr>
</tbody>
</table>
<p>We import the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plasma_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/plasma.txt"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Observational studies have suggested that low dietary intake or low plasma concentrations of retinol, beta-carotene, or other carotenoids might be associated with increased risk of developing certain types of cancer… We designed a cross-sectional study to investigate the relationship between personal characteristics and dietary factors, and plasma concentrations of retinol, beta-carotene and other carotenoids. <span class="citation" data-cites="harrell2002PlasmaRetinolBetaCarotene">(<a href="#ref-harrell2002PlasmaRetinolBetaCarotene" role="doc-biblioref">Harrell 2002</a>)</span></p>
</blockquote>
</section>
</section>
<section id="inference-and-prediction" class="level1">
<h1>Inference and prediction</h1>
<p>According to the good statistical practices we should not look at the data before deciding on the model structure. We are going to follow this rule and hypothesize about the model without looking at the data. This is especially important if the objective is not prediction, but inference (i.e.&nbsp;if our goal is to infer something about the significance of parameters, rather than to predict the next observation). We will break down our study into two parts.</p>
<ul>
<li>First, we will <em>hypothesize about the relationship</em> between some variables (basically making a scientific hypothesis and trying to falsify it). We measure success by statistical significance of individual coefficients and the model as a whole.</li>
<li>Then, we will <em>predict the next observation</em> (without necessarily paying much attention to the significance of individual coefficients). In this task, the success will be measured by the quality of our predictions out of sample.</li>
</ul>
<p>As <span class="citation" data-cites="wickham2016DataScienceImport">Wickham and Grolemund (<a href="#ref-wickham2016DataScienceImport" role="doc-biblioref">2016</a>)</span> puts it:</p>
<blockquote class="blockquote">
<p>Each observation can either be used for exploration or confirmation, not both. You can use an observation as many times as you like for exploration, but you can only use it once for confirmation. As soon as you use an observation twice, you’ve switched from confirmation to exploration.</p>
</blockquote>
<section id="univariate-models" class="level2">
<h2 class="anchored" data-anchor-id="univariate-models">Univariate model(s)</h2>
<p>Our inference hypothesis is that the dietary amount of consumed beta-carotene (BC) affects the content of beta-carotene in plasma. In order to falsify this hypothesis, we will create a linear model and hypothesize that coefficients in that model are zero. Our model:</p>
<p><span class="math display">\[Y=\alpha+\beta X+\varepsilon\]</span>,</p>
<p>where <span class="math inline">\(Y\)</span> is amount of BC in plasma, <span class="math inline">\(X\)</span> is dietary consumption of BC and <span class="math inline">\(\varepsilon\)</span> is the normally distributed error term. Our null hypothesis is that both intercept <span class="math inline">\(\alpha\)</span> and slope <span class="math inline">\(\beta\)</span> are zero, i.e.&nbsp;there’s no effect of consumption of BC on the content of BC in the blood (neither on average, nor per unit of BC consumption).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bc1_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(betaplasma<span class="sc">~</span>betadiet, <span class="at">data=</span>plasma_df)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bc1_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = betaplasma ~ betadiet, data = plasma_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-285.18  -93.12  -38.32   33.26 1156.40 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.300e+02  1.807e+01   7.195 4.68e-12 ***
betadiet    2.764e-02  6.848e-03   4.036 6.83e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 178.7 on 312 degrees of freedom
Multiple R-squared:  0.04963,   Adjusted R-squared:  0.04658 
F-statistic: 16.29 on 1 and 312 DF,  p-value: 6.832e-05</code></pre>
</div>
</div>
<p>As our model shows, we can reject the hypothesis about the no effect of consumed BC on the content of BC in plasma with quite a high confidence. Even though the <span class="math inline">\(R^2\)</span> is pretty low, the p-value for the model is significant. It means that (let me see if I can get this right):</p>
<blockquote class="blockquote">
<p>Assuming that our null hypothesis is true (that there’s no effect of consumed BC on the BC content in plasma) under the ininite series of replications we would find the data as extreme or more extreme as this one in 0.683% of such replications.</p>
</blockquote>
<p>The same can be said about the intercept and slope separately. The individual hypotheses for the slope and intercept should be spelled out in a similar manner:</p>
<ul>
<li><strong>slope</strong>: One unit of increase of BC consumption is associated with exactly zero units increase of BC in plasma</li>
<li><strong>intercept</strong>: Zero consumption of BC is associated with exactly zero content of BC in plasma.</li>
</ul>
<p>We could hypothesize that the alcohol use is associated with BC in plasma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>bc2_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(betaplasma<span class="sc">~</span>alcohol, <span class="at">data=</span>plasma_df)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bc2_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = betaplasma ~ alcohol, data = plasma_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-177.63 -100.38  -48.94   38.87 1223.61 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 191.6253    10.7020  17.906   &lt;2e-16 ***
alcohol      -0.3430     0.8392  -0.409    0.683    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 183.2 on 312 degrees of freedom
Multiple R-squared:  0.0005353, Adjusted R-squared:  -0.002668 
F-statistic: 0.1671 on 1 and 312 DF,  p-value: 0.683</code></pre>
</div>
</div>
<p>No, unfortunately not. Using this data we can not claim that alcohol consumption is associated with the BC in plasma (the slope is not significant).</p>
<p>Last univariate model to try. Let’s say that the amount of consumed fiber is associated with the BC in plasma. We check it with the following model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bc3_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(betaplasma<span class="sc">~</span>fiber, <span class="at">data=</span>plasma_df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bc3_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = betaplasma ~ fiber, data = plasma_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-241.96  -91.51  -43.97   31.69 1169.44 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   86.468     26.109   3.312  0.00104 ** 
fiber          8.138      1.885   4.317 2.13e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 178 on 312 degrees of freedom
Multiple R-squared:  0.05636,   Adjusted R-squared:  0.05333 
F-statistic: 18.63 on 1 and 312 DF,  p-value: 2.129e-05</code></pre>
</div>
</div>
<p>Yes! Based on this data we can claim that given that our null hypothesis (about the absence of association of the fiber consumption with BC in plasma) is true, under infinite number of replications we would find the data to be as extreme or more extreme than this 0.213% of the time. Again, interpretation of the slope is the unit increas in the BC content in plasma per unit increase in fiber consumption and the intercept - the BC content in plasma corresponding to 0 fiber consumption.</p>
<blockquote class="blockquote">
<p>Note! That there could be no causal inference made in this case. Fiber does not “cause” BC content in plasma. There could very well be confounding variables that give rise to this association, so the association (and the corresponding p-value) can very well be spurious. We created no causal model (DAG) and, therefore, we can not determine whether all the relevant controls have been accounted for in this data (or whether it is possible to make any causal queries in this dataset at all).</p>
</blockquote>
</section>
<section id="multivariate-model" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-model">Multivariate model</h2>
</section>
</section>
<section id="references" class="level1 unnumbered">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-harrell2002PlasmaRetinolBetaCarotene" class="csl-entry" role="doc-biblioentry">
Harrell, Frank. 2002. <span>“Plasma Retinol and Beta-Carotene Dataset.”</span> <a href="https://hbiostat.org/data/repo/plasma.html">https://hbiostat.org/data/repo/plasma.html</a>.
</div>
<div id="ref-wickham2016DataScienceImport" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. First edition. Sebastopol, CA: O’Reilly.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Not present in the current version of the dataset<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Not present in the current version of the dataset<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>